<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Input - TD</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../assets/_mkdocstrings.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">TD</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../about/" class="nav-link">About</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">Input</a>
                            </li>
                            <li class="navitem">
                                <a href="../use/" class="nav-link">Use</a>
                            </li>
                            <li class="navitem">
                                <a href="../td/" class="nav-link">Code documentation</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../about/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../use/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#input-file-format" class="nav-link">Input file format</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#periods" class="nav-link">Periods</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#period-formatting" class="nav-link">Period formatting</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#period-elements" class="nav-link">Period elements</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#intervals" class="nav-link">Intervals</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#administrations" class="nav-link">Administrations</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#procedures" class="nav-link">Procedures</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#special-notation" class="nav-link">Special notation</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#exact-procedure-times" class="nav-link">Exact procedure times</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exact-dose-information" class="nav-link">Exact dose information</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="input-file-format">Input file format</h1>
<p>The td.py tool expects a json-formatted input file (see <a href="../use/">Use</a>) that specifies the study elements to be rendered.</p>
<p>In general, the <a href="https://en.wikipedia.org/w/index.php?title=JSON&amp;oldid=1065106487">json format</a> has specific syntactic requirements in order to be read correctly by TD:</p>
<ul>
<li>All json elements are enclosed in curly brackets, including the complete input file</li>
<li>Fields within elements have a name that must be enclosed in quotes, e.g., "caption", followed by a colon and the respective value</li>
<li>Values can be numerical, character (i.e., enclosed in quotes), other json elements, or lists (enclosed in square brackets) of any of the previous</li>
<li>Fields must be separated by commas, but there is no comma after the respective last element</li>
</ul>
<p>The below overview specifies the specific expected format of the json-formatted input file to describe the trial design elements.</p>
<h2 id="periods">Periods</h2>
<p>On the highest level, clinical study elements within the input file are expected to be structured in <em>periods</em> or <em>cycles</em>. Both options are possible and essentially equivalent.</p>
<p>As a minimum, each <em>period</em> or <em>cycle</em> element needs to have <em>caption</em>, <em>start</em> and <em>duration</em> fields. A minimum period "Period 1" that includes days 1 through 7 is described like this:</p>
<pre><code class="language-json">{
    &quot;caption&quot;: &quot;Period 1&quot;,
    &quot;start&quot;: 1,
    &quot;duration&quot;: 7
}
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the period definition is enclosed in curly brackets. In the json format used here, this is used to structure elements. You will see below that objects can themselves contain objects. In additino, some elements are grouped together in a list. Lists are delimited in square brackets. </p>
</div>
<p>In the input file, periods, even if only one is defined, are expected as a <em>periods</em> list. A minimal viable input file could look like this:</p>
<pre><code class="language-json">{
    &quot;periods&quot;: [
        {
            &quot;caption&quot;: &quot;Period 1&quot;,
            &quot;start&quot;: 1,
            &quot;duration&quot;: 7
        }
    ]
}
</code></pre>
<p>The respective output is:</p>
<p><img alt="" src="../sample1.svg" /></p>
<p>Further periods can be added as more members to <em>periods</em>, e.g.:</p>
<pre><code class="language-json">{
    &quot;periods&quot;: [
        {
            &quot;caption&quot;: &quot;Period 1&quot;,
            &quot;start&quot;: 1,
            &quot;duration&quot;: 7
        },
        {
            &quot;caption&quot;: &quot;Period 2&quot;,
            &quot;start&quot;: 1,
            &quot;duration&quot;: 7
        }
    ]
}
</code></pre>
<p><img alt="" src="../sample2.svg" /></p>
<h3 id="period-formatting">Period formatting</h3>
<p>Additional fields can be added to the <em>period</em> elements to specify the visual output. Each <em>period</em> can have the following fields:</p>
<ul>
<li><em>daylabels</em>, a list of days for which daynumbers will be printed.</li>
<li><em>dayshading</em>, a list of days for which the day box will have a grey background. This can be used to highlight relevant days, e.g., weekend days.</li>
</ul>
<pre><code class="language-json">{
    &quot;periods&quot;: [
        {
            &quot;caption&quot;: &quot;Period 1&quot;,
            &quot;start&quot;: -1,
            &quot;duration&quot;: 8,
            &quot;daylabels&quot;: [-1, 1, 2, 3, 6, 7],
            &quot;dayshading&quot;: [1, 7]
        }
    ]
}
</code></pre>
<p><img alt="" src="../sample3.svg" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Wherever lists of days are expected as the input to a field, there are different options. In the simplest case, a list of day numbers can be provided:</p>
<p><code>[-1, 1, 2, 3, 5, 7]</code></p>
<p>If subsequent days are to be specified, it may be more convenient to use a range format. Note that ranges need to be provided with enclosing double quotes. Individual days and ranges can be combined:</p>
<p><code>[-1, "1-3", 5, 7]</code></p>
</div>
<h2 id="period-elements">Period elements</h2>
<p>To every <em>period</em>, elements can be appended. There are three classes of elements: <em>intervals</em>, <em>administrations</em> and <em>procedures</em>. Individual elements of these classes must be given as a list of the respective types (see examples below). This results in a hierarchical structure of the input file where lists can have members that themselves may contain lists of child elements.</p>
<p>To better visualize the hierarchy, successive indentation levels are used in the json blocks shown in this documentation. Note that this is not a strict requirement for the json-formatted input file, however it is considered good practice.</p>
<p>The three element classes have different visual representations and may have different property fields. The following gives an overview on this.</p>
<h3 id="intervals">Intervals</h3>
<p>Intervals are typically used to denote hospitalization phases or ambulatory visits, and are represented in the output as boxes spanning the respective days. There are two different ways of specifying intervals:</p>
<ul>
<li>
<p>For intervals that span multiple days, a <em>start</em> and <em>duration</em> must be given.</p>
</li>
<li>
<p>For single-day intervals, a list of <em>days</em> can be given instead. The duration is then assumed to be one day.</p>
</li>
</ul>
<p>A valid example may look like this:</p>
<pre><code class="language-json">{
    &quot;periods&quot;: [
        {
            &quot;caption&quot;: &quot;Period 1&quot;,
            &quot;start&quot;: -1,
            &quot;duration&quot;: 10,
            &quot;daylabels&quot;: [-1, &quot;1-9&quot;],
            &quot;intervals&quot;: [
                {
                    &quot;caption&quot;: &quot;hospitalization&quot;,
                    &quot;start&quot;: -1,
                    &quot;duration&quot;: 4
                },
                {
                    &quot;caption&quot;: &quot;ambulatory visit&quot;,
                    &quot;days&quot;: [5, 7, 9]
                }
            ]
        }
    ]
}
</code></pre>
<p><img alt="" src="../sample4.svg" /></p>
<h3 id="administrations">Administrations</h3>
<p>IMP administrations are shown in the output using arrow symbols. The minimally required fields are <em>caption</em> and <em>days</em>. As mentioned <a href="#specifying-days">above</a>, <em>days</em> is expected to be a list of numbers or double-quoted day ranges. Both are used in the below example:</p>
<pre><code class="language-json">{
    &quot;periods&quot;: [
        {
            &quot;caption&quot;: &quot;Period 1&quot;,
            &quot;start&quot;: -1,
            &quot;duration&quot;: 10,
            &quot;daylabels&quot;: [-1, &quot;1-9&quot;],
            &quot;administrations&quot;: [
                {
                    &quot;caption&quot;: &quot;aspirin&quot;,
                    &quot;days&quot;: [1]
                },
                {
                    &quot;caption&quot;: &quot;paracetamole&quot;,
                    &quot;days&quot;: [5, 6, 7]
                }
            ]
        },
        {
            &quot;caption&quot;: &quot;Period 2&quot;,
            &quot;start&quot;: 10,
            &quot;duration&quot;: 4,
            &quot;daylabels&quot;: [&quot;10-14&quot;],
            &quot;administrations&quot;: [
                {
                    &quot;caption&quot;: &quot;aspirin&quot;,
                    &quot;days&quot;: [11]
                }
            ]
        }
    ]
}
</code></pre>
<p><img alt="" src="../sample5.svg" /></p>
<h3 id="procedures">Procedures</h3>
<p>All other study assessments (e.g., blood sampling, ECG, etc.) are specified as <em>procedures</em>.</p>
<p>In general, study procedures may be conducted once per day or multiple times per day. In the graphical representation, the respective symbols are diamonds and boxes. The frequency of a <em>procedure</em> can be specified using the <em>freq</em> field: "QD" indicates once daily, while "rich" indicates multiple daily time points. For "QD", the <em>freq</em> field can also be omitted (e.g., for the ECG on day 5, below).</p>
<pre><code class="language-json">{
    &quot;periods&quot;: [
        {
            &quot;caption&quot;: &quot;Period 1&quot;,
            &quot;start&quot;: -1,
            &quot;duration&quot;: 8,
            &quot;daylabels&quot;: [-1, &quot;1-7&quot;],
            &quot;procedures&quot;: [
                {
                    &quot;caption&quot;: &quot;ECG&quot;,
                    &quot;days&quot;: [-1],
                    &quot;freq&quot;: &quot;QD&quot;
                },
                {
                    &quot;caption&quot;: &quot;ECG&quot;,
                    &quot;days&quot;: [5]
                },
                {
                    &quot;caption&quot;: &quot;ECG&quot;,
                    &quot;days&quot;: [7],
                    &quot;freq&quot;: &quot;rich&quot;
                }
            ]
        }
    ]
}
</code></pre>
<p><img alt="" src="../sample6.svg" /></p>
<h2 id="special-notation">Special notation</h2>
<h3 id="exact-procedure-times">Exact procedure times</h3>
<p>As a more granular alternative to the rather coarse definition of the procedure frequency using the <em>freq</em> field, precise preocedure times can be noted for procedures, e.g., for PK samplings. The times (in hours) is to be provided as a list to the <em>times</em> field. In addition, a <em>relative</em> field must be provided to clearly indicate to which day the times refer:</p>
<pre><code class="language-json">{
    &quot;periods&quot;: [
        {
            &quot;caption&quot;: &quot;Period 1&quot;,
            &quot;start&quot;: -1,
            &quot;duration&quot;: 8,
            &quot;daylabels&quot;: [-1, &quot;1-7&quot;],
            &quot;procedures&quot;: [
                {
                    &quot;caption&quot;: &quot;ECG&quot;,
                    &quot;days&quot;: [1],
                    &quot;times&quot;: [0, 0.5, 1, 2, 4, 6, 8, 12, 24, 36, 48],
                    &quot;relative&quot;: 1
                }
            ]
        }
    ]
}
</code></pre>
<p>This notation automatically assigns the right symbols for the days onto which the time points fall. In the above example, the time point list indicates that there are multiple time points on days 1 and 2 (leading to a box symbol for these days) but a single time point on day 2 (diamond symbol):</p>
<p><img alt="" src="../sample7.svg" /></p>
<p>Sometimes, it is desirable to print a more detailed timeline for a procedure (e.g., to show the PK sampling schedule). This can be achieved by adding a <em>timescale</em> field with the value "show". In addition, as described on the <a href="../use/">Use</a> page, the commandline parameter <code>--timescale</code> (or short <code>-t</code>) must be set to achieve this.</p>
<pre><code class="language-json">{
    &quot;periods&quot;: [
        {
            &quot;caption&quot;: &quot;Period 1&quot;,
            &quot;start&quot;: -1,
            &quot;duration&quot;: 8,
            &quot;daylabels&quot;: [-1, &quot;1-7&quot;],
            &quot;procedures&quot;: [
                {
                    &quot;caption&quot;: &quot;PK sampling&quot;,
                    &quot;days&quot;: [1],
                    &quot;times&quot;: [0, 0.5, 1, 2, 4, 6, 8, 12, 24, 36, 48],
                    &quot;relative&quot;: 1,
                    &quot;timescale&quot;: &quot;show&quot;
                }
            ]
        }
    ]
}
</code></pre>
<p><img alt="" src="../sample8.svg" /></p>
<p>(Created by invoking: <code>python td.py -t sample.jpg</code>)</p>
<h3 id="exact-dose-information">Exact dose information</h3>
<p>In some cases, the dose for an IMP changes over time in a scheduled way, e.g. to phase in or out a sensitive drug. In this cases, the respective administration element can include specific dosing information using a numerical <em>dose</em> field. The below example shows a dose escalation for carbamazepine:</p>
<pre><code class="language-json">&quot;administrations&quot;: [
    {
        &quot;caption&quot;: &quot;carbamazepine BID&quot;,
        &quot;days&quot;: [&quot;8-9&quot;],
        &quot;dose&quot;: 100
    },
    {
        &quot;caption&quot;: &quot;carbamazepine BID&quot;,
        &quot;days&quot;: [&quot;10-11&quot;],
        &quot;dose&quot;: 200
    },
    {
        &quot;caption&quot;: &quot;carbamazepine BID&quot;,
        &quot;days&quot;: [&quot;12-32&quot;],
        &quot;dose&quot;: 300
    }
]
</code></pre>
<p>As detailed under <a href="../use/#dose-graph">"use"</a>, a dose graph can then be displayed in the output to indicate the dose over time.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Rainer Strotmann, Jan-2022</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
